---
title: "Beyond Treatment: Modeling the Transmission Implications of Fecal Transplant for Clostridium Difficile Infection in Health-Care Settings"
author:
- Jacob Carey
- Sarah Cox
- Katie Goodman
- Alex Pyden
date: "`r format(Sys.time(), '%d %B %Y')`"
bibliography: bibliography.bib
abstract: |
  **Objective —** In “Epidemiological Model for *Clostridium Difficile* Transmission in Health-Care Settings,” published by Lanzas et al. in 2011, the authors developed a compartmental mathematical model of *C.  difficile* nosocomial transmission (the “*Lanzas* model”). The paper highlights the importance of patient-patient transmission to *C.  difficile* burden in hospital settings, as the authors found that the transmission coefficients associated with colonized and/or symptomatically diseased patients were significant drivers of whether R0 was greater or less than 1. Since publication, however, fecal transplantation to restore endogenous flora has gained increasing acceptance as a curative therapy for *C. difficile*. To date, the majority of attention has focused on fecal transplantation’s clinical implications, but it also fundamentally alters susceptibility and recovery rates relative to conventional antibiotic-based regimens. These rates are directly relevant to *C. difficile* transmission dynamics, in particular transmission from symptomatically diseased patients, but to our knowledge have not been modeled in the literature. Our objective was to update the *Lanzas* model to incorporate fecal transplant as an alternative to antibiotic treatment in order to evaluate resulting effects on *C. difficile* hospital-based transmission.  
  **Design —** Retrospective cohort.  
  **Setting and Patients —** All patients admitted to the medical wards at a large tertiary care hospital in the United States between January 1 and December 31, 2008 (underlying study cohort of Lanzas *et al.*, 2011).  
  **Methods —** The *Lanzas* model was modified to include fecal transplant, in addition to antibiotic therapy, as treatment for *C.  difficile* infection (CDI). To incorporate fecal transplant, we altered the original model in two primary ways: (1) Collapse of the two asymptomatically colonized states, C^-^ and C^+^ (with and without protection against CDI), into a single colonized state, C; and (2) Expansion of the single “susceptible to colonization” state, S, into separate compartments: “susceptible to colonization following antibiotic treatment” (S~a~) and “susceptible to colonization following fecal transplant” (S~f~). The modified model includes five possible transition states: resistant to colonization (R), susceptible to colonization following antibiotic therapy (S~a~), susceptible to colonization following fecal transplant (S~f~), asymptomatically colonized (C), and patients with symptomatic disease (D). Addition of new parameters to reflect fecal transplant-associated transition rates among compartments were derived from the literature.  
output: pdf_document
documentclass: article
header-includes:
- \usepackage{tikz}
- \usetikzlibrary{arrows, automata}
---
\newpage

```{r chunks, echo=FALSE}
knitr::opts_chunk$set(echo=FALSE,
                      message=FALSE,
                      eval=FALSE)
```

```{r libs}
# libraries
library(deSolve)
library(ggplot2)
library(dplyr)
library(tidyr)
theme_set(theme_classic())

# programs
source("../R/model.R")
source("../R/stochasticModel.R")
source("../R/calcR0.R")
```

```{r params}
# parameters
a.r <- 0.75
a.s <- a.s.abx <- 0.22
a.cn <- a.cp <- a.c <- 0.01
a.d <- 0.01
alpha <- 0.5
theta <- 0.033
theta.abx <- 0.033
theta.ft <- 1.0
beta.c <- beta.d <- 0.007
f <- 0.6
epsilon <- epsilon.abx <- 0.1
epsilon.ft <- 1.0
p <- p.abx <- 0.8
p.ft <- 0.9
psi <- 0.2
phi <- 0.04
k.r <- 0.33
k <- 0.15
k.d <- 0.068

# sequence of times
max.time <- 2.5e1
times <- seq(0, max.time, 1) 

# delta
delta <- 1e-1
```

```{r old-model}
# parameter vector
param <- c(a.r=a.r, a.s=a.s, a.cn=a.cn, a.cp=a.cp, a.d=a.d, alpha=alpha,
           theta=theta, beta.c=beta.c, beta.d=beta.d, f=f, 
           epsilon=epsilon, p=p, phi=0.2, k.r=k.r, k=k, k.d=k.d)

# initial state
initial.state <- c(R=1e3, S=0, P=0, C=1e1, D=0)

model.old <- lsoda(initial.state, times, dx.dt.orig, param, delta=delta)
```

```{r new-model}
# parameter vector
param <- c(a.r=a.r, a.s.abx=a.s.abx, a.c=a.c, a.d=a.d, alpha=alpha,
           theta.abx=theta.abx, theta.ft=theta.ft, beta.c=beta.c, beta.d=beta.d,  
           epsilon.abx=epsilon.abx, p.abx=p.abx, phi=phi, k.r=k.r, k=k, k.d=k.d,
           epsilon.ft=epsilon.ft, p.ft=p.ft, psi=psi)

# initial state
initial.state <- c(R=1e3, S.ft=0, S.abx=0, C=1e1, D=0)

model.new <- lsoda(initial.state, times, dx.dt.new, param, delta=delta)
```

```{r new-model-valid}
# parameter vector
param <- c(a.r=a.r, a.s.abx=a.s.abx, a.c=a.c, a.d=a.d, alpha=alpha,
           theta.abx=theta.abx, theta.ft=theta.ft, beta.c=beta.c, beta.d=beta.d,  
           epsilon.abx=epsilon.abx, p.abx=p.abx, phi=phi, k.r=k.r, k=k, k.d=k.d,
           epsilon.ft=epsilon.ft, p.ft=p.ft, psi=0)

# initial state
initial.state <- c(R=1e3, S.ft=0, S.abx=0, C=1e1, D=0)

model.new.valid <- lsoda(initial.state, times, dx.dt.new, param, delta=delta)
```

# Introduction
*Clostridium difficile* (*C. difficile*) infection (CDI) represents the
most common healthcare-acquired infection in the United States (Lessa,
Mu et al. 2015). Between 2000 and 2010, rates of *C. difficile*
hospitalizations more than doubled, and CDI now constitutes nearly
half-a-million infections per year. These infections exert a significant
population health and economic toll: CDI has emerged as the leading
cause of gastro-enteritis-associated death, accounting for more than
14,000 U.S. deaths per year, and entails excess yearly hospital costs of
more than \$1 billion (Miller, Chen et al. 2011, Dubberke and Olsen
2012, Magill, Edwards et al. 2014).

*C. difficile* is particularly vexing in healthcare settings because of
high patient susceptibility and easily facilitated transmission. *C.
difficile* is a Gram-positive bacteria that may sometimes be present
asymptomatically in small numbers in the intestinal tract (such
individuals are “colonized”). During and following antibiotic exposure,
however, as other gut flora dies off an ecological vacuum is created in
which *C. difficile* rapidly replicates. *C. difficile* produces an
exotoxin, which at high bacterial loads will cause symptomology and
severe diarrhea — that is, CDI. Hospitalized patients, who frequently
take antibiotics, are at high risk of CDI, and it is estimated that CDI
risk increases 6-fold during and in the month following antibiotic
exposure (Thomas, Stevenson et al. 2003, Hensgens, Goorhuis et al.
2012). Moreover, both asymptomatically colonized and actively diseased
individuals shed *C. difficile* in stool and can contaminate healthcare
workers and surrounding environments. In particular, *C. difficile* is
capable of forming spores which can survive for long periods as fomites
and are not killed by alcohol-based hand sanitizers (Wilcox and Fawley
2000). For these reasons, inter-patient spread and CDI outbreaks are
common in healthcare environments. The standard treatment for CDI is
antibiotics — generally metronidazole, vancomycin, or fidaxomicin — but
recurrence rates following treatment are high (Austin, Mellow et al.
2014).

Reducing the burden of healthcare-associated CDI represents an ongoing
focus of infection control and antimicrobial stewardship initiatives.
Better understanding *C. difficile* transmission in healthcare
environments is integral to these efforts. In “Epidemiological Model for
*Clostridium Difficile* Transmission in Health-Care Settings,” published
by Lanzas *et al.* in 2011, the authors developed a compartmental
mathematical model of *C. difficile* nosocomial transmission (the
“*Lanzas* model”) (Lanzas, Dubberke et al. 2011). Their paper
highlighted the importance of patient-patient transmission to *C.
difficile* burden in hospital settings, as the authors found that the
transmission coefficients associated with colonized and/or
symptomatically diseased patients were significant drivers of whether
R-0 was greater or less than 1. Since the paper’s 2011 publication,
however, fecal transplantation to restore endogenous flora has gained
increasing acceptance as a curative therapy for *C. difficile*. This
therapy, in which donor feces is administered through nasogastric tube
(or less commonly, endoscopy, colonoscopy or enema), restores normal gut
flora that prevents *C. difficile* overgrowth, and thus toxin
production, and provides resistance against repeat *C. difficile*
colonization (“colonization resistance”). In studies, fecal transplant
has cured recurrent or refractory CDI in \> 90% of patients (Austin,
Mellow et al. 2014).

Unsurprisingly, fecal transplant’s impressive results have garnered
considerable coverage in recent published literature. Its implications
for nosocomial transmission, however, have received significantly less
attention. Yet, fecal transplant is faster than antibiotic treatment
(\~8-24 hours versus 10 days), and often restores gut bacterial
diversity and resolves diarrhea symptomology nearly immediately (Bakken,
Borody et al. 2011). These effects fundamentally alter patient
susceptibility and recovery rates and thus are likely to influence *C.
difficile* transmission dynamics. Therefore, in the present paper our
objective was to update the *Lanzas* model to incorporate fecal
transplant in order to evaluate resulting effects on *C. difficile*
hospital-based transmission.

# Methods

## Data

The updated model retained the same model-fitting data employed by the
original *Lanzas* model. This data encompassed the period from January 1
through December 31, 2008 at Barnes-Jewish Hospital, a large tertiary
facility, in St. Louis, Missouri. For a complete description of patient
and microbiological characteristics, please see Lanzas et al. (2011).

## Epidemiological Model

We expanded the *Lanzas* deterministic compartmental model to include
fecal transplant, in addition to antibiotic therapy, as treatment for
*C. difficile* infection (CDI). To incorporate fecal transplant, we
altered the original model in two ways. *First*, we collapsed the two
asymptomatically colonized states, C^-^ and C^+^ (with and without
immune protection against CDI), into a single colonized state, C. We
elected to employ a single colonized compartment for model parsimony and
due to unclear significance of “immune protection” against *C.
difficile* disease among colonized patients, based on our review of the
published literature. *Second*, we expanded the original “susceptible to
colonization” state, S, into separate compartments: “susceptible to
colonization following antibiotic treatment” (S~a~) and “susceptible to
colonization following fecal transplant” (S~f~). The final modified
model includes five possible transition states: resistant to
colonization (R), susceptible to colonization following antibiotic
therapy (S~a~), susceptible to colonization following fecal transplant
(S~f~), asymptomatically colonized (C), and patients with symptomatic
disease (D) (**Figure 1**). Addition of new parameters to reflect fecal
transplant-associated transition rates among compartments were derived
from the literature. The deterministic differential equations for the
model are contained in **Figure 2**.

[Discuss that output is R-0; then describe how estimated with next
generation matrix]

In order to estimate $R_0$, we derived the Next Generation Matrix for this 
compartmental model, as described in @ngm.

This needs to be updated from SymPy program!

We derive F as
$$
\left[\begin{matrix}\beta_{c} \left(S_{a_0} + S_{f_0}\right) & \beta_{d} \left(S_{a_0} + S_{f_0}\right)\\0 & 0\end{matrix}\right]
$$

V as
$$
\left[\begin{matrix}- k + \phi & 0\\- \phi & \epsilon p \left(- \psi + 1\right) + \epsilon_{f} p_{f} \psi + k_{d}\end{matrix}\right]
$$

and the Next Generation Matrix as
$$
\left[\begin{matrix}\frac{\beta_{c} \left(S_{a_0} + S_{f_0}\right)}{- k + \phi} + \frac{\beta_{d} \phi \left(S_{a_0} + S_{f_0}\right)}{\left(- k + \phi\right) \left(- \epsilon p \left(\psi - 1\right) + \epsilon_{f} p_{f} \psi + k_{d}\right)} & \frac{\beta_{d} \left(S_{a_0} + S_{f_0}\right)}{- \epsilon p \left(\psi - 1\right) + \epsilon_{f} p_{f} \psi + k_{d}}\\0 & 0\end{matrix}\right]
$$

From the Next Generation Matrix, we obtain the spectral radius, which is the
$R_0$ of this model.

$$
- \frac{\left(S_{a_0} + S_{f_0}\right) \left(\beta_{c} \epsilon p \psi - \beta_{c} \epsilon p - \beta_{c} \epsilon_{f} p_{f} \psi - \beta_{c} k_{d} - \beta_{d} \phi\right)}{\left(k - \phi\right) \left(\epsilon p \psi - \epsilon p - \epsilon_{f} p_{f} \psi - k_{d}\right)}
$$

Where $S_{a_0}$ and $S_{f_0}$ are the two susceptible compartments at baseline. However, it should be noted,
that at disease free equilibrium, no persons flow from $R$ to $S_{f_0}$, so $S_{f_0} = 0$. We describe 
$S_{a_0}$ as 
$$
S_{a_0} = \frac{(a_s k_r + \alpha) N}{\alpha + a_s k_r + (1-a_s)k + \theta_a}
$$

**Figure 1: Model Diagram of *Clostridium difficile* transmission in a
hospital environment**

![diagram](diagram.jpg)

**Figure 2: Deterministic Model Differential Equations**


$$
\begin{aligned}
\frac{dR}{dt}=a_r\delta N + \theta_a S_a + \theta_f S_f - k_r R - \alpha R \\
\frac{dS_f}{dt}=p_f \epsilon_f D \psi -\theta_f S_f - kS_f-\lambda S_f \\
\frac{dS_a}{dt}=a_s\delta N + \alpha R + p_a \epsilon_a D (1 - \psi) -\theta_a S_a - kS_a-\lambda S_a \\
\frac{dC}{dt}=a_{c}\delta N + \lambda S_a + \lambda S_f - \phi C- kC \\
\frac{dD}{dt}=a_d\delta N + \phi C - p_a\epsilon_a D(1 - \psi) - p_f \epsilon_f D \psi - k_dD \\
\lambda=\beta_cC+\beta_dD \\
N=R+S_f+S_a+C+D
\end{aligned}
$$

## Parameterization

**Table 1: Deterministic Model Parameters**

\begin{tabular}{|p{1cm}|p{5.5cm}|p{2.5cm}|p{3cm}|p{3cm}|}
\hline
Symbol       & Description (Units)                                                                     & Point Estimate & Range Employed in Sensitivity Analysis          & Source                                                                       \\ \hline
ar           & Proportion of resistant admitted patients                                               & 0.75           & --                                              & Lanzas Data                                                                  \\ \hline
as           & Proportion of susceptible-following-antibiotic-therapy (Sa) admitted patients           & 0.22           & --                                              & Lanzas Estimate (Data-derived)                                               \\ \hline
ac           & Proportion of colonized admitted patients                                               & 0.01           & --                                              & Lanzas Estimate (Data-derived)                                               \\ \hline
ad           & Proportion of diseased admitted patients                                                & 0.01           & --                                              & Lanzas Data                                                                  \\ \hline
$\alpha$        & Antibiotic prescription rate (1/days)                                                   & 0.5            & --                                              & Lanzas Data                                                                  \\ \hline
$\theta$        & Restoration rate of colonization resistance following antibiotic treatment (1/days)     & 0.033          & --                                              & Lanzas Estimate                                                              \\ \hline
$\beta_c, \beta_d$ & Transmission coefficient of infectious (colonized or diseased) patients (1/(ind\*days)) & 0.007          & --                                              & Lanzas Estimate (Rafii, Sutherland et al. 2008)                              \\ \hline
$\psi$          & Proportion of diseased patients that receive fecal transplant                           & 0.20           & 0.00 – 1.0 (values of 0.00, 0.50, and 1.0)      & New Estimate (Abou Chakra, Pepin et al. 2014)                                \\ \hline
$\epsilon_a$     & Antibiotic treatment rate (1/days duration)                                             & 0.10           & --                                              & Lanzas Estimate (McFarland 2008)                                             \\ \hline
pa           & Probability of successful antibiotic treatment                                          & 0.80           & --                                              & Lanzas Estimate (McFarland 2008)                                             \\ \hline
$\epsilon_f$     & Fecal transplant treatment rate (1/days duration)                                       & 1.0            & 0.25 – 2.0 (values of 0.25, 0.50, 1.5, and 2.0) & New Estimate (Austin, Mellow et al. 2014)                                    \\ \hline
pf           & Probability of successful fecal transplant treatment                                    & 0.90           & 0.50 – 1.0 (values of 0.50 and 1.0)             & New Estimate (Austin, Mellow et al. 2014)                                    \\ \hline
$\theta_f$       & Restoration rate of colonization resistance following fecal transplant (1/days)         & 1.0            & -- & New Estimate (Bakken, Borody et al. 2011, Seekatz, Aas et al. 2014)          \\ \hline
$\phi$          & Clinical disease rate at which colonized patients progress to infection (1/days)        & 0.04           & --                                              & Lanzas Estimate (Clabots, Johnson et al. 1992) (Chang, Krezolek et al. 2007) \\ \hline
kr           & Discharge rate for resistant patients (1/days)                                          & 0.33           & --                                              & Lanzas Data                                                                  \\ \hline
k            & Discharge rate for susceptible and colonized patients (1/days)                          & 0.15           & --                                              & Lanzas Data                                                                  \\ \hline
kd           & Discharge rate for diseased patients (1/day)                                            & 0.068          & --                                              & Lanzas Data                                                                  \\ \hline
\end{tabular}

# Results
## Comparison of Baseline Differential Equations
```{r graphs-1, warning=FALSE}
data.old <- model.old %>% 
    data.frame() %>%
    tbl_df() %>%
    gather(compartment, size, R:D) %>%
    mutate(model="Lanzas")

data.new <- model.new %>% 
    data.frame() %>%
    tbl_df() %>%
    gather(compartment, size, R:D) %>%
    mutate(model="New")

data.new.valid <- model.new.valid %>%
    data.frame() %>%
    tbl_df() %>%
    gather(compartment, size, R:D) %>%
    mutate(model="Validation")

ggplot(bind_rows(data.old, data.new, data.new.valid), aes(x=time, y=size)) +
    geom_line(aes(colour=compartment, linetype=compartment)) +
    ggtitle("Deterministic Model Comparison") +
    facet_wrap(~model)
```

## Sensitivity Analyses
Using the Next Generation Matrix derived above, we perform a series
of analyses to understand the behavior of $R_0$ in this theoretical
system. For comparison, $R_0$ in @lanzas was estimated to be 
0.55 - 1.99 in stochastic simulations. In our model, $R_0$ was estimated to be
`r calc.R0(20, param)`, using a ward size of 30 which is similar to what was 
done in @lanzas.

```{r sens-range}
# orig vals
N <- 20
psi.old <- param["psi"]
epsilon.ft.old <- param["epsilon.ft"]
p.ft.old <- param["p.ft"]
theta.ft.old <- param["theta.ft"]

print("psi")
for (psi.temp in c(0, 0.5, 1)) {
    param["psi"] <- psi.temp
    print(calc.R0(N, param))
    param["psi"] <- psi.old
}

print("ep.f")
for (ep.temp in c(0.25, 0.5, 1.5, 2.0)) {
    param["epsilon.ft"] <- ep.temp
    print(calc.R0(N, param))
    param["epsilon.ft"] <- epsilon.ft.old
}

print("p.ft")
for (p.ft.temp in c(0.5, 1)) {
    param["p.ft"] <- p.ft.temp
    print(calc.R0(N, param))
    param["p.ft"] <- p.ft.old
}

# best case scenario

param["psi"] <- 1
param["epsilon.ft"] <- 2
param["p.ft"] <- 1

# change params back
param["p.ft"] <- p.ft.old
param["epsilon.ft"] <- epsilon.ft.old
param["psi"] <- psi.old
```


## Simulation
```{r simulation-lanzas}
simulations <- 2e1

param <- c(a.r=a.r, a.s=a.s, a.cn=a.cn, a.cp=a.cp, a.d=a.d, alpha=alpha,
           theta=theta, beta.c=beta.c, beta.d=beta.d, f=f, 
           epsilon=epsilon, p=p, phi=0.2, k.r=k.r, k=k, k.d=k.d)

# initial state
initial.state <- c(R=1e3, S=0, P=0, C=1e1, D=0)

lanzas.attack.rate <- stochastic.sim(param, initial.state,
                                     stochastic.dx.dt, simulations)
```

```{r simulation-new}
param <- c(a.r=a.r, a.s.abx=a.s.abx, a.c=a.c, a.d=a.d, alpha=alpha,
           theta.abx=theta.abx, theta.ft=theta.ft, beta.c=beta.c, beta.d=beta.d,  
           epsilon.abx=epsilon.abx, p.abx=p.abx, phi=phi, k.r=k.r, k=k, k.d=k.d,
           epsilon.ft=epsilon.ft, p.ft=p.ft, psi=psi)

# initial state
initial.state <- c(R=1e3, S.abx=0, S.ft=0, C=1e1, D=0)

new.attack.rate <- stochastic.sim(param, initial.state,
                                  stochastic.dx.dt.new, simulations)
```

```{r simulation-new-bestcase}
param <- c(a.r=a.r, a.s.abx=a.s.abx, a.c=a.c, a.d=a.d, alpha=alpha,
           theta.abx=theta.abx, theta.ft=2.0, beta.c=beta.c, beta.d=beta.d,  
           epsilon.abx=epsilon.abx, p.abx=p.abx, phi=phi, k.r=k.r, k=k, k.d=k.d,
           epsilon.ft=2.0, p.ft=1.0, psi=1.0)

# initial state
initial.state <- c(R=1e3, S.abx=0, S.ft=0, C=1e1, D=0)

new.attack.rate.bestcase <- stochastic.sim(param, initial.state,
                                  stochastic.dx.dt.new, simulations)
```

We ran `r simulations` simulations and we saw an attack rate of 
`r lanzas.attack.rate[2]` (95% ci `r lanzas.attack.rate[c(1, 3)]`) and
`r new.attack.rate[2]` (95% CI `r new.attack.rate[c(1, 3)]`) in the 
original model and new model respectively. We varied the relevant parameters
in the stochastic simulation of the fecal-transplant model, but did not see
much of a change in the behavior of the attack rate.

best-case AR: `r new.attack.rate.bestcase[2]` (95% CI `r new.attack.rate.bestcase[c(1, 3)]`)

For computational analysis, we used R version 3.2.0 (@rcore). We used the
SymPy library for symbolic mathematics (@sympy).

# Discussion

# References
