{
    "contents" : "---\ntitle: \"C Diff and Math!\"\nauthor:\n- Jacob Carey\n- Sarah Cox\n- Katie Goodman\n- Alex Pyden\ndate: \"`r format(Sys.time(), '%d %B %Y')`\"\nbibliography: bibliography.bib\nabstract: |\n  We propose an extended compartmental model to explore the transmission dynamics of hospital-acquired _C. diff_. \n  Our model will address the shortcomings of @lanzas by explicitly modeling transmission of _C. diff_. via health care workers and via the environment. \n  Additionally, since @lanzas was published, treatment of these infections has significantly advanced and thus we will account for this innovation in our model. \n  Some of the parameters for our model will be estimated from the literature. \n  For these parameters, we will perform a sensitivity analysis to account for the uncertainty. \n  Finally, we numerically solve a system of ordinary differential equations using the R statistical package to estimate the remaining transmission and timing parameters.\n\noutput: pdf_document\ndocumentclass: article\nheader-includes:\n- \\usepackage{tikz}\n- \\usetikzlibrary{arrows, automata}\n---\n\\newpage\n\n```{r chunks, echo=FALSE}\nknitr::opts_chunk$set(echo=FALSE,\n                      message=FALSE)\n```\n\n```{r runme, eval=FALSE}\n# run this line to create the PDF!\n# you might have to change the path \n# i.e. \"~/Documents/grad-school-sucks/project.Rmd\"\n# rmarkdown::render(\"doc/project.Rmd\")\n```\n\n```{r libs}\n# libraries\nlibrary(deSolve)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\ntheme_set(theme_classic())\n\n# programs\nsource(\"../R/model.R\")\nsource(\"../R/stochasticModel.R\")\n```\n\n```{r params}\n# parameters\na.r <- 0.75\na.s <- 0.22\na.cn <- a.cp <- 0.01\na.d <- 0.01\nalpha <- 0.5\ntheta <- 0.033\nbeta.c <- beta.d <- 0.007\nf <- 0.6\nepsilon <- 0.1\ne <- 0.01\np <- 0.8\nrho <- 0.8\nphi <- 0.2\nk.r <- 0.33\nk <- 0.15\nk.d <- 0.068\n\n# sequence of times\nmax.time <- 2.5e1\ntimes <- seq(0, max.time, 1) \n\n# delta\ndelta <- 1e-1\n```\n\n```{r old-model}\n# parameter vector\nparam <- c(a.r=a.r, a.s=a.s, a.cn=a.cn, a.cp=a.cp, a.d=a.d, alpha=alpha,\n           theta=theta, beta.c=beta.c, beta.d=beta.d, f=f, \n           epsilon=epsilon, p=p, phi=phi, k.r=k.r, k=k, k.d=k.d)\n\n# initial state\ninitial.state <- c(R=1e3, S=0, P=0, C=1e1, D=0)\n\nmodel.old <- lsoda(initial.state, times, dx.dt.orig, param, delta=delta)\n```\n\n```{r new-model, eval=FALSE}\n# parameter vector\nparam <- c(a.r=a.r, a.s=a.s, a.c=a.c, a.d=a.d, alpha=alpha,\n           theta=theta, beta.c=beta.c, beta.d=beta.d, f=f, \n           epsilon=epsilon, p=p, phi=phi, k.r=k.r, k=k, k.d=k.d,\n           e=e, rho=rho)\n\n# initial state\ninitial.state <- c(R=1e3, S=0, C=1e1, D=0)\n\nmodel.new <- lsoda(initial.state, times, dx.dt.new, param, delta=delta)\n```\n\n# Introduction\nIn @lanzas, the authors investigated the transmission dynamics of _Clostridium difficile_ (_C. diff._) using a compartmental model.\n_C. diff_ is the leading cause of infectious diarrhea in hospitals and is one of the most common causes of healthcare-acquired infections.\n_C. diff_ is a pathogenic bacteria that occasionally replaces the normal bacterial microbiota of a patient’s intestines following clearance by antibiotic treatment, resulting in a diarrheal illness.\nThe paper highlights the importance of transmission to C. diff. burden in hospital settings, as the authors found that the transmission coefficients associated with colonized and/or symptomatically infected patients were significant drivers of whether $R_0$ was greater or less than 1.\nAs the model makes some simplifying assumptions about transmission, the authors recommend that future models explicitly incorporate different routes of transmission.\nMoreover, with the emergence of fecal transplantation as curative therapy since publication, some of the model’s compartmental assumptions and parameter estimates surrounding treatment may need to be altered.\n\nThe expansion of this model has significance to hospital epidemiology policy-setting in health care systems and hospitals globally.\nIn the United States specifically, _C. diff._ represents a significant ongoing source of healthcare-associated infections, adding at least one billion dollars to the cost of healthcare every year and causing substantial patient morbidity (@stop-c-diff).\nBetter understanding the dynamics of _C. diff._ transmission within hospital environments is critical to developing appropriate infection control strategies and, in turn, to reducing _C. diff_ burden.\n\nWe believe that the expansions proposed in our model are necessary to achieve this objective.\n_C. diff._ is relatively unusual among bacterial pathogens, because it has the ability to form spores which are not killed by alcohol-based sanitizers.\nSomewhat parodoxically, therefore, although the transition from soap and water to alcohol sanitizers has increased hospital hand hygiene compliance (due to ease of use), it has likely accelerated transmission of _C. diff._ via healthcare workers.\nMoreover, since @lanzas was published, the environmental cleaning landscape in hospitals has evolved.\nThe ongoing Ebola outbreak has heightened infection control awareness, and many hospitals have invested in gas- or UV-based apparatuses that can thoroughly decontaminate patient rooms.\nThese devices, relative to historical environmental cleaning methods, are more efficacious against _C. diff._ spores.\nConsequently, modifying the original model to account for these changes and complexities is critical to accurately modeling the anticipated effects — or unintended consequences — of different infection control policies.\n\nMoreover, since 2011 fecal transplantation to restore endogenous flora has gained increasing acceptance as a curative therapy for _C. diff._\nTo date, the majority of attention has focused on fecal transplantation’s clinical implications.\nHowever, it also fundamentally alters susceptible and recovery rates relative to conventional antibiotic-based regimens.\nThese rates are directly relevant to _C. diff._ transmission dynamics but to our knowledge have not been modeled in the literature.\n\nWe also read @pelupessy_2002.\n\n# Methods\n\n## Data\n\n## Epidemiological Model\n\nThe original model in @lanzas was described by the following system of differential equations.\n$$\n\\begin{aligned}\n\\frac{dR}{dt}=a_r\\delta N + \\theta S - k_r R - \\alpha R \\\\\n\\frac{dS}{dt}=a_s\\delta N + \\alpha R + p \\epsilon D -\\theta S - kS-\\lambda S \\\\\n\\frac{dC^{-}}{dt}=a_{cn}\\delta N + (1-f) \\lambda S - \\psi C^{-} - kC^{-} \\\\\n\\frac{dC^{+}}{dt}=a_{cp}\\delta N + f\\lambda S - kC^{+} \\\\\n\\frac{dD}{dt}=a_d\\delta N + \\psi C^{-} - p\\epsilon D - k_dD \\\\\n\\lambda=\\beta_c(C^{-}+C{+})+\\beta_dD \\\\\nN=R+S+C^{-}+C^{+}+D\n\\end{aligned}\n$$\nWe reran the model, but set delta equal to `r delta` (deterministically).\n\nWe modified the @lanzas model and collapsed the colonized compartments into one colonized compartment, and did not distinguish between immune status. We chose to remove this distinction as it seemed somewhat arbitrary. It's not supported in the literature? Reference?\n\n\\newpage\n\nWe conceptualized our model in this framework. (Note that the parameters aren't final!\n\n\\begin{center}\n    \\begin{tikzpicture}[\n        > = stealth, % arrow head style\n        auto,\n        node distance = 3cm, % distance between nodes\n        semithick % line style\n        ]\n\n        \\tikzstyle{every state}=[\n            draw = black,\n            thick,\n            fill = white,\n            minimum size = 4mm\n        ]\n\n        \\node[state] (R) {Resistant};\n        \\node[state] (S1) [below left of=R] {Susceptible 1};\n        \\node[state] (S2) [below right of=R] {Susceptible 2};\n        \\node[state] (C) [below left of=S2] {Colonized};\n        \\node[state] (D) [below of=C] {Diseased};\n\n        \\path[->] (R) edge node {$\\alpha$} (S1);\n        \\path[->] (R) edge node {$\\alpha$} (S2);\n        \\path[->] (S2) edge node {$\\beta$} (R);\n        \\path[->] (S1) edge node {$\\gamma$} (C);\n        \\path[->] (S2) edge node {$\\gamma$} (C);\n        \\path[->] (C) edge node {$\\epsilon$} (D);\n        \\path[->] (D) edge node {$\\theta$} (S1);\n        \\path[->] (D) edge node {$\\theta$} (S2);\n\n    \\end{tikzpicture}\n\\end{center}\n\n$$\n\\begin{aligned}\n\\frac{dR}{dt}=a_r\\delta N + \\theta_a S_a + \\theta_f S_f - k_r R - \\alpha R \\\\\n\\frac{dS_f}{dt}=\\alpha R + \\rho e D \\tau -\\theta_f S_f - kS_f-\\lambda S_f \\\\\n\\frac{dS_a}{dt}=a_s\\delta N + \\alpha R + p \\epsilon D (1 - \\tau) -\\theta_a S_a - kS_a-\\lambda S \\\\\n\\frac{dC}{dt}=a_{cn}\\delta N + \\lambda S_a + \\lambda S_f - \\psi C- kC \\\\\n\\frac{dD}{dt}=a_d\\delta N + \\psi C - p\\epsilon D(1 - \\tau) - \\rho e D \\tau - k_dD \\\\\n\\lambda=\\beta_cC+\\beta_dD \\\\\nN=R+S+C+D\n\\end{aligned}\n$$\n\n## Parameterization\n\n## Next Generation Matrix\nhttp://www.ncbi.nlm.nih.gov/pmc/articles/PMC1578275/pdf/rsif20050042.pdf\nhttp://web.stanford.edu/~jhj1/teachingdocs/Jones-on-R0.pdf\nhttp://daphnia.ecology.uga.edu/ceesg/wp-content/uploads/2013/12/nextgen.pdf\nhttp://rsif.royalsocietypublishing.org/content/royinterface/7/47/873.full.pdf\n\nRecommended by Derek\nhttp://www.luchsinger-mathematics.ch/vandenDriessche-R0Compartmental-2002.pdf\n\n\n\n# Results\n## Comparison of Baseline Differential Equations\n```{r graphs-old}\ndata <- model.old %>% \n    data.frame() %>%\n    tbl_df() %>%\n    gather(compartment, size, R:D)\n\nggplot(data, aes(x=time, y=size)) +\n    geom_line(aes(colour=compartment, linetype=compartment)) +\n    ggtitle(\"Old Model\")\n```\n\n```{r graphs-new, eval=FALSE}\ndata <- model.new %>% \n    data.frame() %>%\n    tbl_df() %>%\n    gather(compartment, size, R:D)\n\nggplot(data, aes(x=time, y=size)) +\n    geom_line(aes(colour=compartment, linetype=compartment)) +\n    ggtitle(\"Collapsed Colonized Compartments\")\n```\n\n## Simulation\n```{r simulation-lanzas}\nsimulations <- 1e3\n\nparam <- c(a.r=a.r, a.s=a.s, a.cn=a.cn, a.cp=a.cp, a.d=a.d, alpha=alpha,\n           theta=theta, beta.c=beta.c, beta.d=beta.d, f=f, \n           epsilon=epsilon, p=p, phi=phi, k.r=k.r, k=k, k.d=k.d)\n\n# initial state\ninitial.state <- c(R=1e3, S=0, P=0, C=1e1, D=0)\n\nlanzas.attack.rate <- stochastic.sim(param, initial.state,\n                                     stochastic.dx.dt)\n```\n\n```{r simulation-new}\nnew.attack.rate <- lanzas.attack.rate\n```\n\nWe ran `r simulations` and we saw an attack rate of \n`r lanzas.attack.rate[2]` (95% CI `r lanzas.attack.rate[c(1, 3)]`) and\n`r new.attack.rate[2]` (95% CI `r new.attack.rate[c(1, 3)]`) in the \noriginal model and new model respectively.\n\n# Discussion\n\n# References\n",
    "created" : 1431552148231.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1631075054",
    "id" : "3B8C0081",
    "lastKnownWriteTime" : 1431551433,
    "path" : "~/IDD C. diff/doc/project.Rmd",
    "project_path" : "doc/project.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}